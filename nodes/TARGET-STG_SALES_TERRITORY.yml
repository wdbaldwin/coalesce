steps:
  STG_SALES_TERRITORY-534:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: |-
          select * from "COALESCE_TRAINING"."COALESCE_SOURCE"."SALES_TERRITORY"
          UNPIVOT 
          ( 
          "Quota" FOR "Year" IN ("2019_QUOTA" ,"2020_QUOTA" ,"2021_QUOTA" ,"2022_QUOTA") 
          ) AS unpvt
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      dependencies: []
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: TARGET
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 11000
              stepCounter: "534"
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: TERRITORY_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 10984
                    stepCounter: "532"
                transform: ""
          - columnReference:
              columnCounter: 11001
              stepCounter: "534"
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COUNTY_REGION_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 10985
                    stepCounter: "532"
                transform: UPPER("SALES_TERRITORY"."COUNTY_REGION_CODE")
          - columnReference:
              columnCounter: 11002
              stepCounter: "534"
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: TERRITORY_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 10986
                    stepCounter: "532"
                transform: ""
          - columnReference:
              columnCounter: 11003
              stepCounter: "534"
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: TERRITORY_GROUP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 10987
                    stepCounter: "532"
                transform: ""
          - columnReference:
              columnCounter: 11004
              stepCounter: "534"
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: 2019_QUOTA
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 10988
                    stepCounter: "532"
                transform: ""
          - columnReference:
              columnCounter: 11005
              stepCounter: "534"
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: 2020_QUOTA
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 10989
                    stepCounter: "532"
                transform: ""
          - columnReference:
              columnCounter: 11006
              stepCounter: "534"
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: 2021_QUOTA
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 10990
                    stepCounter: "532"
                transform: ""
          - columnReference:
              columnCounter: 11007
              stepCounter: "534"
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: 2022_QUOTA
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 10991
                    stepCounter: "532"
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCE
                nodeName: SALES_TERRITORY
            join:
              joinCondition: FROM {{ ref('SOURCE', 'SALES_TERRITORY') }} "SALES_TERRITORY"
            name: STG_SALES_TERRITORY
            noLinkRefs: []
      name: STG_SALES_TERRITORY
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: "534"
